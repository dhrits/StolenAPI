from ..people import Person

dummy = {u'avatar': {u'filesize': -1,
  u'height': -1,
  u'id': u'00001cce-b1f2-e3a9-840d-0012023964ef',
  u'is_yours': True,
  u'mimetype': None,
  u'source': 1,
  u'type': 1,
  u'url': u'https://pbs.twimg.com/profile_images/419292050790842368/WDXNPdlw.jpeg',
  u'width': -1},
 u'bio': {u'entities': {u'hashtags': [], u'urls': []},
  u'text': u'Coder. Comic enthusiast.'},
 u'cover': {u'filesize': -1,
  u'height': -1,
  u'id': u'00001cce-b1f2-ea4c-840e-001202392c52',
  u'is_yours': True,
  u'mimetype': None,
  u'source': 1,
  u'type': 2,
  u'url': u'https://pbs.twimg.com/profile_banners/44831234/1420255066',
  u'width': -1},
 u'created_at': 1451744474.297983,
 u'first_logged_in': 1452564108.647005,
 u'gemwallet': {u'gems': 0, u'modified': 1451744474.302612},
 u'golden_ticket': True,
 u'has_logged_in': True,
 u'id': u'00001cce-b1f2-767f-8406-00120239f93c',
 u'identities': [{u'created_at': 1451744474.321921,
   u'follower_count': 1708,
   u'friend_count': 623,
   u'id': u'00001cce-b1f2-d401-840b-00120239bdab',
   u'modified': 1452564108.633593,
   u'type': 1,
   u'user_id': u'44831234',
   u'username': u'deman48'}],
 u'is_you': True,
 u'lastsale': {u'canonical_price': 58376.0,
  u'current_harvest_amount': 853.0,
  u'decay_rate': 2.09125860871917,
  u'display_price': 65965.0,
  u'last_harvest_date': 1452743228.664085,
  u'last_sale_date': 1452741420.060255,
  u'last_sale_price': 62801.0,
  u'new_worth': 70966.0,
  u'owner_id': u'00001CCA-9634-4ED2-8682-001B19AAA207',
  u'purchase_uuid': u'BEE550D3-4B26-42D4-B90C-E7C61E5332A3',
  u'seconds_since_harvest': 10769.500501,
  u'seconds_since_sale': 12578.104323,
  u'total_times_purchased': 37},
 u'modified': 1452749344.662247,
 u'name': u'Dhritiman Sagar',
 u'net_worth': 1547511.0,
 u'nickname': None,
 u'owner': {u'avatar': {u'filesize': -1,
   u'height': -1,
   u'id': u'00001cca-9634-940c-8689-001b19aaedeb',
   u'is_yours': False,
   u'mimetype': None,
   u'source': 1,
   u'type': 1,
   u'url': u'https://pbs.twimg.com/profile_images/451737354277900291/TuflBxdg.png',
   u'width': -1},
  u'bio': {u'entities': {u'hashtags': [], u'urls': []},
   u'text': u'Senior Software Engineer at Twitter, inc. Doing iOS dev on @vine'},
  u'cover': {u'filesize': -1,
   u'height': -1,
   u'id': u'00001cca-9634-9773-868a-001b19aa5028',
   u'is_yours': False,
   u'mimetype': None,
   u'source': 1,
   u'type': 2,
   u'url': u'https://pbs.twimg.com/profile_banners/436383882/1396632699',
   u'width': -1},
  u'created_at': 1451726828.98197,
  u'first_logged_in': 1452696166.759687,
  u'has_logged_in': True,
  u'id': u'00001cca-9634-4ed2-8682-001b19aaa207',
  u'identities': [{u'created_at': 1451726828.998519,
    u'follower_count': 832,
    u'friend_count': 154,
    u'id': u'00001cca-9634-8f77-8687-001b19aa8dc6',
    u'modified': 1452696166.747319,
    u'type': 1,
    u'user_id': u'436383882',
    u'username': u'MichelLoenngren'}],
  u'is_you': False,
  u'lastsale': {u'canonical_price': 61484.0,
   u'current_harvest_amount': 32.0,
   u'decay_rate': 1.5041555820856,
   u'display_price': 69477.0,
   u'last_harvest_date': 1452753586.959882,
   u'last_sale_date': 1452749176.878485,
   u'last_sale_price': 62735.0,
   u'new_worth': 70891.0,
   u'owner_id': u'000018E5-06BC-AA66-E13B-001D3097988B',
   u'purchase_uuid': u'BD5A16AF-0EC8-4701-983C-140B9504CC94',
   u'seconds_since_harvest': 411.205398,
   u'seconds_since_sale': 4821.286789,
   u'total_times_purchased': 34},
  u'modified': 1452753979.64056,
  u'name': u'Michel Loenngren',
  u'nickname': None,
  u'pet_slots': 24,
  u'pet_worth': 552052.0,
  u'tags': [],
  u'theme': None,
  u'verified': False,
  u'you_follow': False},
 u'pet_slots': 24,
 u'pet_worth': 1238865.0,
 u'tags': [],
 u'theme': None,
 u'vault': {u'capacity': 2400.0,
  u'last_collection_time': 1452685575.787561,
  u'level': 1900.0,
  u'recharge_time': 86400.0},
 u'verified': False,
 u'wallet': {u'balance': 308646.0, u'modified': 1452749344.564757},
 u'you_follow': True}

def _almost_equals(num1, num2, places=3):
    return round(abs(num1 - num2), places) == 0.0

def test_person_fields():
    p = Person(dummy)
    assert p.id.lower() == '00001cce-b1f2-767f-8406-00120239f93c'
    assert p.username == u'deman48'
    assert p.user_id == u'44831234'
    assert p.follower_count == 1708
    assert p.friend_count == 623
    assert not p.verified
    assert _almost_equals(p.display_price, 65965.0)
    assert p.purchase_uuid == u'BEE550D3-4B26-42D4-B90C-E7C61E5332A3'
    assert p.owner_id == u'00001CCA-9634-4ED2-8682-001B19AAA207'
    assert _almost_equals(p.seconds_since_harvest, 10769.500501)
    assert _almost_equals(p.seconds_since_sale, 12578.104323)
    assert p.total_times_purchased == 37
    assert _almost_equals(p.new_worth, 70966.0)
    assert _almost_equals(p.current_harvest_amount, 853.0)
    assert p.owner.id.upper() == u'00001CCA-9634-4ED2-8682-001B19AAA207'
    
